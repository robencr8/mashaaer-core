<!DOCTYPE html>
<html>
<head>
    <title>CORS Test for Ultra Minimal Server</title>
</head>
<body>
    <h1>CORS Test</h1>
    <p>This page tests CORS configuration by making a fetch request to the server.</p>
    
    <button id="testBtn">Test API Connection</button>
    <div id="result" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>
    
    <script>
        document.getElementById('testBtn').addEventListener('click', function() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testing connection...';
            
            // Get the current host and port for the test
            const currentHost = window.location.hostname;
            const currentPort = window.location.port;
            const apiUrl = `http://${currentHost}:${currentPort}/api/ping`;
            
            console.log(`Testing API at: ${apiUrl}`);
            
            fetch(apiUrl)
                .then(response => {
                    console.log('Response status:', response.status);
                    console.log('Response headers:', response.headers);
                    return response.json();
                })
                .then(data => {
                    console.log('Response data:', data);
                    resultDiv.innerHTML = `
                        <p style="color: green;">✅ Connection successful!</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                })
                .catch(error => {
                    console.error('Error:', error);
                    resultDiv.innerHTML = `
                        <p style="color: red;">❌ Connection failed!</p>
                        <pre>${error.message}</pre>
                        <p>Check browser console for details.</p>
                    `;
                });
        });
    </script>
</body>
</html>
