<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedback Tool Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        #results {
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            padding: 10px;
            margin-top: 20px;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        button {
            padding: 10px 15px;
            background: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        .endpoints {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Feedback Tool Test</h1>
    <p>This page tests minimal endpoints to verify connectivity with the Feedback Tool.</p>
    
    <div class="endpoints">
        <button onclick="testEndpoint('/health')">Test /health</button>
        <button onclick="testEndpoint('/api/ping')">Test /api/ping</button>
        <button onclick="testEndpoint('/api/minimal')">Test /api/minimal</button>
        <button onclick="testEndpoint('/api/status')">Test /api/status</button>
        <button onclick="testEndpoint('/feedback-tool-endpoint')">Test /feedback-tool-endpoint</button>
        <button onclick="testEndpoint('/api/debug-request')">Test /api/debug-request</button>
    </div>

    <div id="results">Results will appear here...</div>

    <script>
        function testEndpoint(endpoint) {
            const resultsDiv = document.getElementById('results');
            const fullUrl = window.location.origin + endpoint;
            
            resultsDiv.innerHTML = `Testing: ${fullUrl}\n\nPlease wait...`;
            
            const startTime = new Date().getTime();
            
            fetch(fullUrl, {
                method: 'GET',
                headers: {
                    'Accept': '*/*',
                    'X-Test': 'feedback-tool-test'
                }
            })
            .then(response => {
                const endTime = new Date().getTime();
                const responseTime = endTime - startTime;
                
                let resultText = `Endpoint: ${endpoint}\n`;
                resultText += `Full URL: ${fullUrl}\n`;
                resultText += `Status: ${response.status} ${response.statusText}\n`;
                resultText += `Response Time: ${responseTime}ms\n\n`;
                
                resultText += "Response Headers:\n";
                for (const [key, value] of response.headers.entries()) {
                    resultText += `${key}: ${value}\n`;
                }
                
                return response.text().then(text => {
                    resultText += "\nResponse Body (first 1000 chars):\n";
                    resultText += (text.length > 1000) ? text.substring(0, 1000) + "..." : text;
                    
                    resultsDiv.innerHTML = `<span class="success">✅ SUCCESS</span>\n\n${resultText}`;
                });
            })
            .catch(error => {
                resultsDiv.innerHTML = `<span class="error">❌ ERROR</span>\n\nFailed to connect to ${fullUrl}\n\nError details: ${error.message}`;
                
                // Additional diagnostic information
                resultsDiv.innerHTML += `\n\nBrowser information: ${navigator.userAgent}`;
                resultsDiv.innerHTML += `\n\nOrigin: ${window.location.origin}`;
                resultsDiv.innerHTML += `\n\nProtocol: ${window.location.protocol}`;
                resultsDiv.innerHTML += `\n\nHostname: ${window.location.hostname}`;
                resultsDiv.innerHTML += `\n\nPort: ${window.location.port || "(default)"}`;
            });
        }
    </script>
</body>
</html>
