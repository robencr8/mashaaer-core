<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชุจุงุฑ ุงูุตูุช | ูุดุงุนุฑ</title>
    <style>
        body { 
            font-family: Arial; 
            background-color: #1a1a2e;
            color: white;
            text-align: center;
            padding: 20px;
            direction: rtl;
        }
        h1 { color: #8a2be2; }
        button { 
            background-color: #8a2be2;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 20px;
            cursor: pointer;
        }
        #log { 
            margin-top: 20px; 
            background-color: rgba(0,0,0,0.3);
            padding: 10px;
            text-align: right;
            border-radius: 5px;
            height: 200px;
            overflow-y: auto;
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
    </style>
</head>
<body>
    <h1>ุงุฎุชุจุงุฑ ุชุดุบูู ุงูุตูุช ูู ูุดุงุนุฑ</h1>

    <button onclick="playAudio('/static/sounds/welcome.mp3', 'ุตูุช ุงูุชุฑุญูุจ')">ุชุดุบูู ุตูุช ุงูุชุฑุญูุจ</button>
    <button onclick="playAudio('/static/sounds/click.mp3', 'ุตูุช ุงูููุฑ')">ุชุดุบูู ุตูุช ุงูููุฑ</button>
    <button onclick="playApiSound()">ุชุดุบูู ุตูุช ูู API</button>
    <div>
        <audio id="audioPlayer" controls style="margin-top: 20px;"></audio>
    </div>

    <div id="log"></div>

    <script>
        const audioPlayer = document.getElementById('audioPlayer');
        const log = document.getElementById('log');

        function logMessage(message, type = 'info') {
            const entry = document.createElement('div');
            entry.textContent = message;
            entry.className = type;
            log.insertBefore(entry, log.firstChild);
            console.log(`[${type}] ${message}`);
        }

        function playAudio(src, description) {
            logMessage(`ูุญุงููุฉ ุชุดุบูู ${description}...`);
            
            try {
                audioPlayer.src = src;
                audioPlayer.load(); // ุถุฑูุฑู ูุจุนุถ ุงููุชุตูุญุงุช
                
                audioPlayer.play()
                    .then(() => logMessage(`โ ุชู ุชุดุบูู ${description} ุจูุฌุงุญ`, 'success'))
                    .catch(error => {
                        logMessage(`โ๏ธ ูุดู ุชุดุบูู ${description}: ${error}`, 'warning');
                        
                        if (error.name === 'NotAllowedError') {
                            logMessage('๐ก ูุตูุญุฉ: ุงููุชุตูุญ ูููุน ุชุดุบูู ุงูุตูุช ุชููุงุฆููุง. ุชุฃูุฏ ูู ุชูุงุนู ุงููุณุชุฎุฏู ุฃููุงู.', 'info');
                        } else if (error.name === 'NotSupportedError') {
                            logMessage('๐ก ูุตูุญุฉ: ุตูุบุฉ ุงูุตูุช ุบูุฑ ูุฏุนููุฉ. ุฌุฑุจ ุตูุบุฉ MP3.', 'info');
                        }
                    });
            } catch (e) {
                logMessage(`โ ุฎุทุฃ ุนุงู: ${e.message}`, 'error');
            }
        }

        function playApiSound() {
            logMessage('ุฌุงุฑู ุทูุจ ุตูุช ูู API...');
            
            fetch('/api/play-cosmic-sound?sound_type=welcome&language=ar')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`ุฎุทุฃ ูู ุงูุงุณุชุฌุงุจุฉ: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.success && data.sound_path) {
                        logMessage(`โ ุชู ุงุณุชูุงู ูุณุงุฑ ุงูุตูุช: ${data.sound_path}`, 'success');
                        playAudio(data.sound_path, 'ุตูุช API');
                    } else {
                        logMessage(`โ๏ธ ุงุณุชุฌุงุจุฉ API ุบูุฑ ุตุญูุญุฉ: ${JSON.stringify(data)}`, 'warning');
                    }
                })
                .catch(error => {
                    logMessage(`โ ุฎุทุฃ ูู ุทูุจ API: ${error.message}`, 'error');
                });
        }

        audioPlayer.addEventListener('error', (e) => {
            let errorMsg = 'ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุนุฑูู';
            
            if (audioPlayer.error) {
                switch (audioPlayer.error.code) {
                    case 1: errorMsg = 'ุชู ุฅูุบุงุก ุชุญููู ุงููุณุงุฆุท'; break;
                    case 2: errorMsg = 'ุฎุทุฃ ูู ุงูุดุจูุฉ'; break;
                    case 3: errorMsg = 'ูุดู ูู ูู ุชุดููุฑ ุงููุณุงุฆุท'; break;
                    case 4: errorMsg = 'ุงููุณุงุฆุท ุบูุฑ ูุฏุนููุฉ'; break;
                }
            }
            
            logMessage(`โ ุฎุทุฃ ูู ูุดุบู ุงูุตูุช: ${errorMsg}`, 'error');
        });

        // ุฑุณุงูุฉ ุชุฑุญูุจูุฉ
        logMessage('๐ ูุฑุญุจูุง! ูุฐู ุงูุตูุญุฉ ุชุฎุชุจุฑ ุชุดุบูู ุงูุตูุช ูู ูุดุงุนุฑ.');
        logMessage('๐ก ูุตูุญุฉ: ุงุถุบุท ุนูู ุฃุญุฏ ุงูุฃุฒุฑุงุฑ ูุชุดุบูู ุงูุตูุช.');
    </script>
</body>
</html>
